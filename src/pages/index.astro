---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = await getCollection('blog');
const sorted = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const base = import.meta.env.BASE_URL;
---
<BaseLayout title="我的博客">
  <h1 class="page-title">文章列表</h1>
  <ul class="post-list">
    {sorted.map(post => {
      const formattedDate = post.data.date.toLocaleDateString('zh-CN', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
      });
      return (
        <li>
          <a href={`${base}posts/${post.id}`}>{post.data.title}</a>
          <time datetime={post.data.date.toISOString()}>{formattedDate}</time>
        </li>
      );
    })}
  </ul>
</BaseLayout>
